nohup: ignoring input
Euclidean
INFO:root:Using:{args.device}
INFO:root:Using seed 1234.
loading a file...../../data/Openea/EN_DE_15K_V1/ent_links_id
loading a file...../../data/Openea/EN_DE_15K_V1/test_links
loading a file...../../data/Openea/EN_DE_15K_V1/train_links
loading a file...../../data/Openea/EN_DE_15K_V1/valid_links
train ILL num: 3000,valid ILL num: 1500, test ILL num: 10500
train ILL | valid ILL |test ILL num: 15000
train ILL & valid ILL &test ILL num: 0
loading a file...../../data/Openea/EN_DE_15K_V1/triples_1
loading a file...../../data/Openea/EN_DE_15K_V1/triples_2
loading a (id2object)file...  ../../data/Openea/EN_DE_15K_V1/ent_ids_1
loading a (id2object)file...  ../../data/Openea/EN_DE_15K_V1/ent_ids_2
loading a (id2object)file...  ../../data/Openea/EN_DE_15K_V1/rel_ids_1
loading a (id2object)file...  ../../data/Openea/EN_DE_15K_V1/rel_ids_2
getting a sparse tensor r_adj...
/home/huangpeng/syn-master/src/Attribute/load_data.py:13: RuntimeWarning: divide by zero encountered in power
  r_inv_sqrt = np.power(rowsum, -0.5).flatten()
/home/huangpeng/syn-master/src/Attribute/load_data.py:26: RuntimeWarning: divide by zero encountered in power
  r_inv_sqrt = np.power(rowsum, -1).flatten()
entity:adding the primal init layer
Traceback (most recent call last):
  File "main.py", line 249, in <module>
    train(args)
  File "main.py", line 31, in train
    data["ent_features_n"]=get_e_init_layer(args,args.ent_vec_path_n,data['ent_sizes'],data['train_ill'],args.normalize_feats)
  File "/home/huangpeng/syn-master/src/Attribute/load_data.py", line 441, in get_e_init_layer
    embedding=load_embedding(file_path,normalize_feats)
  File "../utils/data_utils.py", line 35, in load_embedding
    with open(file=file_path, mode='rb') as f:
FileNotFoundError: [Errno 2] No such file or directory: '../../save_data/Openea/EN_DE_15K_V1/init_entity_embedding_bert_int_des.p'
nohup: ignoring input
Euclidean
INFO:root:Using:{args.device}
INFO:root:Using seed 1234.
loading a file...../../data/Openea/EN_DE_15K_V1/ent_links_id
loading a file...../../data/Openea/EN_DE_15K_V1/test_links
loading a file...../../data/Openea/EN_DE_15K_V1/train_links
loading a file...../../data/Openea/EN_DE_15K_V1/valid_links
train ILL num: 3000,valid ILL num: 1500, test ILL num: 10500
train ILL | valid ILL |test ILL num: 15000
train ILL & valid ILL &test ILL num: 0
loading a file...../../data/Openea/EN_DE_15K_V1/triples_1
loading a file...../../data/Openea/EN_DE_15K_V1/triples_2
loading a (id2object)file...  ../../data/Openea/EN_DE_15K_V1/ent_ids_1
loading a (id2object)file...  ../../data/Openea/EN_DE_15K_V1/ent_ids_2
loading a (id2object)file...  ../../data/Openea/EN_DE_15K_V1/rel_ids_1
loading a (id2object)file...  ../../data/Openea/EN_DE_15K_V1/rel_ids_2
getting a sparse tensor r_adj...
/home/huangpeng/syn-master/src/Attribute/load_data.py:13: RuntimeWarning: divide by zero encountered in power
  r_inv_sqrt = np.power(rowsum, -0.5).flatten()
/home/huangpeng/syn-master/src/Attribute/load_data.py:26: RuntimeWarning: divide by zero encountered in power
  r_inv_sqrt = np.power(rowsum, -1).flatten()
entity:adding the primal init layer
30000 rows, 300 columns.
entity:adding the primal init layer
30000 rows, 300 columns.
relation:adding the primal init layer
239 rows, 300 columns.
relation:adding the primal init layer
239 rows, 300 columns.
value:adding the primal init layer
Traceback (most recent call last):
  File "main.py", line 249, in <module>
    train(args)
  File "main.py", line 38, in train
    data["val_features"] = get_v_init_layer(args, args.val_vec_path,args.normalize_feats)
  File "/home/huangpeng/syn-master/src/Attribute/load_data.py", line 462, in get_v_init_layer
    embedding = load_embedding(file_path, normalize_feats)
  File "../utils/data_utils.py", line 35, in load_embedding
    with open(file=file_path, mode='rb') as f:
FileNotFoundError: [Errno 2] No such file or directory: '../../save_data/Openea/EN_DE_15K_V1/random'
nohup: ignoring input
Euclidean
INFO:root:Using:{args.device}
INFO:root:Using seed 1234.
loading a file...../../data/Openea/EN_DE_15K_V1/ent_links_id
loading a file...../../data/Openea/EN_DE_15K_V1/test_links
loading a file...../../data/Openea/EN_DE_15K_V1/train_links
loading a file...../../data/Openea/EN_DE_15K_V1/valid_links
train ILL num: 3000,valid ILL num: 1500, test ILL num: 10500
train ILL | valid ILL |test ILL num: 15000
train ILL & valid ILL &test ILL num: 0
loading a file...../../data/Openea/EN_DE_15K_V1/triples_1
loading a file...../../data/Openea/EN_DE_15K_V1/triples_2
loading a (id2object)file...  ../../data/Openea/EN_DE_15K_V1/ent_ids_1
loading a (id2object)file...  ../../data/Openea/EN_DE_15K_V1/ent_ids_2
loading a (id2object)file...  ../../data/Openea/EN_DE_15K_V1/rel_ids_1
loading a (id2object)file...  ../../data/Openea/EN_DE_15K_V1/rel_ids_2
getting a sparse tensor r_adj...
/home/huangpeng/syn-master/src/Attribute/load_data.py:13: RuntimeWarning: divide by zero encountered in power
  r_inv_sqrt = np.power(rowsum, -0.5).flatten()
/home/huangpeng/syn-master/src/Attribute/load_data.py:26: RuntimeWarning: divide by zero encountered in power
  r_inv_sqrt = np.power(rowsum, -1).flatten()
entity:adding the primal init layer
30000 rows, 300 columns.
entity:adding the primal init layer
30000 rows, 300 columns.
relation:adding the primal init layer
239 rows, 300 columns.
relation:adding the primal init layer
239 rows, 300 columns.
value:adding the primal init layer
attribute:adding the primal init layer
INFO:root:Total number of parameters: {tot_params}
Euclidean
INFO:root:BaseModel(
  (ins_embeddings_a): Embedding(30000, 300, max_norm=1)
  (rel_embeddings_a): Embedding(479, 300, max_norm=1)
  (ins_embeddings_n): Embedding(30000, 300, max_norm=1)
  (rel_embeddings_n): Embedding(479, 300, max_norm=1)
  (encoder): RREA_adapt(
    (rrgat0): RelationalReflectionGraphAttentionLayer(
      (attention_0): SpRelationalReflectionGraphAttentionLayer (600 -> 600)
    )
    (hact0): HypAct(
      c_in=Parameter containing:
      tensor([1.], requires_grad=True), c_out=Parameter containing:
      tensor([1.], requires_grad=True)
    )
    (rrgat1): RelationalReflectionGraphAttentionLayer(
      (attention_0): SpRelationalReflectionGraphAttentionLayer (600 -> 600)
    )
    (hact1): HypAct(
      c_in=Parameter containing:
      tensor([1.], requires_grad=True), c_out=Parameter containing:
      tensor([1.], requires_grad=True)
    )
  )
  (decoder): RREA_adapt()
)
ins_embeddings_a.weight
rel_embeddings_a.weight
ins_embeddings_n.weight
rel_embeddings_n.weight
encoder.rrgat0.curvature
encoder.rrgat0.attention_0.a
encoder.hact0.c_out
encoder.rrgat1.attention_0.a
encoder.hact1.c_out
Train Entity Alignment:Hits@1: 99.63%Hits@10: 99.97%Hits@50: 100.00%MRR: 0.9979
Valid Entity Alignment:Hits@1: 97.20%Hits@10: 99.13%Hits@50: 99.67%MRR: 0.9791
Test Entity Alignment:Hits@1: 95.11%Hits@10: 97.47%Hits@50: 98.50%MRR: 0.9597
start training...
######################## epoch:  0  ###########################
Valid Entity Alignment:Hits@1: 97.20%MRR: 0.9794
Test Entity Alignment:Hits@1: 95.13%Hits@10: 97.51%Hits@50: 98.55%MRR: 0.9601
Test Entity Alignment:Hits@1: 95.13%Hits@10: 97.51%Hits@50: 98.55%MRR: 0.9601
######################## epoch:  1  ###########################
Valid Entity Alignment:Hits@1: 97.27%MRR: 0.9799
Test Entity Alignment:Hits@1: 95.22%Hits@10: 97.56%Hits@50: 98.60%MRR: 0.9610
Test Entity Alignment:Hits@1: 95.22%Hits@10: 97.56%Hits@50: 98.60%MRR: 0.9610
######################## epoch:  2  ###########################
Valid Entity Alignment:Hits@1: 97.40%MRR: 0.9808
Test Entity Alignment:Hits@1: 95.27%Hits@10: 97.60%Hits@50: 98.64%MRR: 0.9616
Test Entity Alignment:Hits@1: 95.27%Hits@10: 97.60%Hits@50: 98.64%MRR: 0.9616
######################## epoch:  3  ###########################
Valid Entity Alignment:Hits@1: 97.47%MRR: 0.9816
Test Entity Alignment:Hits@1: 95.32%Hits@10: 97.70%Hits@50: 98.69%MRR: 0.9621
Test Entity Alignment:Hits@1: 95.32%Hits@10: 97.70%Hits@50: 98.69%MRR: 0.9621
######################## epoch:  4  ###########################
Valid Entity Alignment:Hits@1: 97.53%MRR: 0.9822
Test Entity Alignment:Hits@1: 95.36%Hits@10: 97.78%Hits@50: 98.70%MRR: 0.9626
Test Entity Alignment:Hits@1: 95.36%Hits@10: 97.78%Hits@50: 98.70%MRR: 0.9626
######################## epoch:  5  ###########################
Valid Entity Alignment:Hits@1: 97.67%MRR: 0.9831
Test Entity Alignment:Hits@1: 95.42%Hits@10: 97.84%Hits@50: 98.76%MRR: 0.9632
Test Entity Alignment:Hits@1: 95.42%Hits@10: 97.84%Hits@50: 98.76%MRR: 0.9632
######################## epoch:  6  ###########################
Valid Entity Alignment:Hits@1: 97.73%MRR: 0.9839
Test Entity Alignment:Hits@1: 95.40%Hits@10: 97.86%Hits@50: 98.83%MRR: 0.9634
Test Entity Alignment:Hits@1: 95.40%Hits@10: 97.86%Hits@50: 98.83%MRR: 0.9634
######################## epoch:  7  ###########################
Valid Entity Alignment:Hits@1: 97.73%MRR: 0.9840
Test Entity Alignment:Hits@1: 95.47%Hits@10: 97.91%Hits@50: 98.87%MRR: 0.9640
Test Entity Alignment:Hits@1: 95.47%Hits@10: 97.91%Hits@50: 98.87%MRR: 0.9640
######################## epoch:  8  ###########################
Valid Entity Alignment:Hits@1: 97.80%MRR: 0.9846
Test Entity Alignment:Hits@1: 95.54%Hits@10: 97.96%Hits@50: 98.92%MRR: 0.9646
Test Entity Alignment:Hits@1: 95.54%Hits@10: 97.96%Hits@50: 98.92%MRR: 0.9646
######################## epoch:  9  ###########################
Valid Entity Alignment:Hits@1: 98.00%MRR: 0.9859
Test Entity Alignment:Hits@1: 95.59%Hits@10: 98.02%Hits@50: 98.96%MRR: 0.9649
Test Entity Alignment:Hits@1: 95.59%Hits@10: 98.02%Hits@50: 98.96%MRR: 0.9649
######################## epoch:  10  ###########################
Valid Entity Alignment:Hits@1: 98.13%MRR: 0.9866
Test Entity Alignment:Hits@1: 95.60%Hits@10: 98.06%Hits@50: 98.98%MRR: 0.9652
Test Entity Alignment:Hits@1: 95.60%Hits@10: 98.06%Hits@50: 98.98%MRR: 0.9652
######################## epoch:  11  ###########################
Valid Entity Alignment:Hits@1: 98.13%MRR: 0.9869
Test Entity Alignment:Hits@1: 95.63%Hits@10: 98.10%Hits@50: 99.01%MRR: 0.9654
Test Entity Alignment:Hits@1: 95.63%Hits@10: 98.10%Hits@50: 99.01%MRR: 0.9654
######################## epoch:  12  ###########################
Valid Entity Alignment:Hits@1: 98.20%MRR: 0.9876
Test Entity Alignment:Hits@1: 95.64%Hits@10: 98.10%Hits@50: 99.05%MRR: 0.9657
Test Entity Alignment:Hits@1: 95.64%Hits@10: 98.10%Hits@50: 99.05%MRR: 0.9657
######################## epoch:  13  ###########################
Valid Entity Alignment:Hits@1: 98.27%MRR: 0.9879
Test Entity Alignment:Hits@1: 95.66%Hits@10: 98.14%Hits@50: 99.09%MRR: 0.9659
Test Entity Alignment:Hits@1: 95.66%Hits@10: 98.14%Hits@50: 99.09%MRR: 0.9659
######################## epoch:  14  ###########################
Valid Entity Alignment:Hits@1: 98.40%MRR: 0.9886
Test Entity Alignment:Hits@1: 95.69%Hits@10: 98.17%Hits@50: 99.12%MRR: 0.9662
Test Entity Alignment:Hits@1: 95.69%Hits@10: 98.17%Hits@50: 99.12%MRR: 0.9662
######################## epoch:  15  ###########################
Valid Entity Alignment:Hits@1: 98.53%MRR: 0.9894
Test Entity Alignment:Hits@1: 95.70%Hits@10: 98.17%Hits@50: 99.11%MRR: 0.9664
Test Entity Alignment:Hits@1: 95.70%Hits@10: 98.17%Hits@50: 99.11%MRR: 0.9664
######################## epoch:  16  ###########################
Valid Entity Alignment:Hits@1: 98.47%MRR: 0.9891
Test Entity Alignment:Hits@1: 95.70%Hits@10: 98.18%Hits@50: 99.14%MRR: 0.9665
######################## epoch:  17  ###########################
Valid Entity Alignment:Hits@1: 98.53%MRR: 0.9895
Test Entity Alignment:Hits@1: 95.74%Hits@10: 98.24%Hits@50: 99.16%MRR: 0.9668
Test Entity Alignment:Hits@1: 95.74%Hits@10: 98.24%Hits@50: 99.16%MRR: 0.9668
######################## epoch:  18  ###########################
Valid Entity Alignment:Hits@1: 98.47%MRR: 0.9891
Test Entity Alignment:Hits@1: 95.73%Hits@10: 98.27%Hits@50: 99.16%MRR: 0.9669
######################## epoch:  19  ###########################
Valid Entity Alignment:Hits@1: 98.47%MRR: 0.9890
Test Entity Alignment:Hits@1: 95.73%Hits@10: 98.27%Hits@50: 99.19%MRR: 0.9669
######################## epoch:  20  ###########################
Valid Entity Alignment:Hits@1: 98.53%MRR: 0.9893
Test Entity Alignment:Hits@1: 95.71%Hits@10: 98.27%Hits@50: 99.22%MRR: 0.9669
######################## epoch:  21  ###########################
Valid Entity Alignment:Hits@1: 98.60%MRR: 0.9896
Test Entity Alignment:Hits@1: 95.74%Hits@10: 98.29%Hits@50: 99.22%MRR: 0.9671
Test Entity Alignment:Hits@1: 95.74%Hits@10: 98.29%Hits@50: 99.22%MRR: 0.9671
######################## epoch:  22  ###########################
Valid Entity Alignment:Hits@1: 98.60%MRR: 0.9896
Test Entity Alignment:Hits@1: 95.74%Hits@10: 98.30%Hits@50: 99.22%MRR: 0.9672
######################## epoch:  23  ###########################
Valid Entity Alignment:Hits@1: 98.60%MRR: 0.9897
Test Entity Alignment:Hits@1: 95.73%Hits@10: 98.30%Hits@50: 99.20%MRR: 0.9671
Test Entity Alignment:Hits@1: 95.73%Hits@10: 98.30%Hits@50: 99.20%MRR: 0.9671
######################## epoch:  24  ###########################
Valid Entity Alignment:Hits@1: 98.60%MRR: 0.9898
Test Entity Alignment:Hits@1: 95.75%Hits@10: 98.30%Hits@50: 99.21%MRR: 0.9672
Test Entity Alignment:Hits@1: 95.75%Hits@10: 98.30%Hits@50: 99.21%MRR: 0.9672
######################## epoch:  25  ###########################
Valid Entity Alignment:Hits@1: 98.60%MRR: 0.9899
Test Entity Alignment:Hits@1: 95.73%Hits@10: 98.30%Hits@50: 99.21%MRR: 0.9672
Test Entity Alignment:Hits@1: 95.73%Hits@10: 98.30%Hits@50: 99.21%MRR: 0.9672
######################## epoch:  26  ###########################
Valid Entity Alignment:Hits@1: 98.60%MRR: 0.9897
Test Entity Alignment:Hits@1: 95.73%Hits@10: 98.30%Hits@50: 99.20%MRR: 0.9672
######################## epoch:  27  ###########################
Valid Entity Alignment:Hits@1: 98.47%MRR: 0.9889
Test Entity Alignment:Hits@1: 95.76%Hits@10: 98.30%Hits@50: 99.20%MRR: 0.9673
######################## epoch:  28  ###########################
Valid Entity Alignment:Hits@1: 98.33%MRR: 0.9882
Test Entity Alignment:Hits@1: 95.75%Hits@10: 98.30%Hits@50: 99.19%MRR: 0.9673
######################## epoch:  29  ###########################
Valid Entity Alignment:Hits@1: 98.33%MRR: 0.9882
Test Entity Alignment:Hits@1: 95.74%Hits@10: 98.29%Hits@50: 99.19%MRR: 0.9673
######################## epoch:  30  ###########################
Valid Entity Alignment:Hits@1: 98.33%MRR: 0.9883
Test Entity Alignment:Hits@1: 95.76%Hits@10: 98.28%Hits@50: 99.20%MRR: 0.9674
######################## epoch:  31  ###########################
Valid Entity Alignment:Hits@1: 98.33%MRR: 0.9882
Test Entity Alignment:Hits@1: 95.77%Hits@10: 98.31%Hits@50: 99.20%MRR: 0.9674
######################## epoch:  32  ###########################
Valid Entity Alignment:Hits@1: 98.33%MRR: 0.9882
Test Entity Alignment:Hits@1: 95.77%Hits@10: 98.33%Hits@50: 99.23%MRR: 0.9674
######################## epoch:  33  ###########################
Valid Entity Alignment:Hits@1: 98.33%MRR: 0.9881
Test Entity Alignment:Hits@1: 95.76%Hits@10: 98.32%Hits@50: 99.23%MRR: 0.9675
######################## epoch:  34  ###########################
Valid Entity Alignment:Hits@1: 98.33%MRR: 0.9881
Test Entity Alignment:Hits@1: 95.77%Hits@10: 98.33%Hits@50: 99.24%MRR: 0.9675
######################## epoch:  35  ###########################
Valid Entity Alignment:Hits@1: 98.33%MRR: 0.9882
Test Entity Alignment:Hits@1: 95.76%Hits@10: 98.32%Hits@50: 99.23%MRR: 0.9674
######################## epoch:  36  ###########################
Valid Entity Alignment:Hits@1: 98.33%MRR: 0.9881
Test Entity Alignment:Hits@1: 95.76%Hits@10: 98.33%Hits@50: 99.22%MRR: 0.9674
######################## epoch:  37  ###########################
Valid Entity Alignment:Hits@1: 98.33%MRR: 0.9881
Test Entity Alignment:Hits@1: 95.77%Hits@10: 98.33%Hits@50: 99.20%MRR: 0.9674
######################## epoch:  38  ###########################
Valid Entity Alignment:Hits@1: 98.33%MRR: 0.9882
Test Entity Alignment:Hits@1: 95.77%Hits@10: 98.34%Hits@50: 99.20%MRR: 0.9674
######################## epoch:  39  ###########################
Valid Entity Alignment:Hits@1: 98.33%MRR: 0.9882
Test Entity Alignment:Hits@1: 95.77%Hits@10: 98.34%Hits@50: 99.19%MRR: 0.9674
######################## epoch:  40  ###########################
Valid Entity Alignment:Hits@1: 98.33%MRR: 0.9882
Test Entity Alignment:Hits@1: 95.77%Hits@10: 98.34%Hits@50: 99.19%MRR: 0.9674
######################## epoch:  41  ###########################
Valid Entity Alignment:Hits@1: 98.33%MRR: 0.9881
Test Entity Alignment:Hits@1: 95.77%Hits@10: 98.35%Hits@50: 99.19%MRR: 0.9674
######################## epoch:  42  ###########################
Valid Entity Alignment:Hits@1: 98.33%MRR: 0.9881
Test Entity Alignment:Hits@1: 95.76%Hits@10: 98.35%Hits@50: 99.17%MRR: 0.9673
######################## epoch:  43  ###########################
Valid Entity Alignment:Hits@1: 98.33%MRR: 0.9881
Test Entity Alignment:Hits@1: 95.76%Hits@10: 98.35%Hits@50: 99.17%MRR: 0.9673
######################## epoch:  44  ###########################
Valid Entity Alignment:Hits@1: 98.33%MRR: 0.9880
Test Entity Alignment:Hits@1: 95.76%Hits@10: 98.35%Hits@50: 99.17%MRR: 0.9674
######################## epoch:  45  ###########################
Valid Entity Alignment:Hits@1: 98.33%MRR: 0.9880
Test Entity Alignment:Hits@1: 95.76%Hits@10: 98.34%Hits@50: 99.17%MRR: 0.9674
######################## epoch:  46  ###########################
Valid Entity Alignment:Hits@1: 98.33%MRR: 0.9880
Test Entity Alignment:Hits@1: 95.75%Hits@10: 98.34%Hits@50: 99.17%MRR: 0.9673
Train Entity Alignment:Hits@1: 100.00%Hits@10: 100.00%Hits@50: 100.00%MRR: 1.0000
Valid Entity Alignment:Hits@1: 98.60%Hits@10: 99.60%Hits@50: 99.87%MRR: 0.9899
Test Entity Alignment:Hits@1: 95.73%Hits@10: 98.30%Hits@50: 99.21%MRR: 0.9672
entity_pair (e1,e2) num is: 750000
False False
INFO:root:Using:{args.device}
INFO:root:Using seed 1234.
loading a file...../../data/Openea/EN_FR_15K_V1/ent_links_id
loading a file...../../data/Openea/EN_FR_15K_V1/test_links
loading a file...../../data/Openea/EN_FR_15K_V1/train_links
loading a file...../../data/Openea/EN_FR_15K_V1/valid_links
train ILL num: 3000,valid ILL num: 1500, test ILL num: 10500
train ILL | valid ILL |test ILL num: 15000
train ILL & valid ILL &test ILL num: 0
loading a file...../../data/Openea/EN_FR_15K_V1/triples_1
loading a file...../../data/Openea/EN_FR_15K_V1/triples_2
loading a (id2object)file...  ../../data/Openea/EN_FR_15K_V1/ent_ids_1
loading a (id2object)file...  ../../data/Openea/EN_FR_15K_V1/ent_ids_2
loading a (id2object)file...  ../../data/Openea/EN_FR_15K_V1/rel_ids_1
loading a (id2object)file...  ../../data/Openea/EN_FR_15K_V1/rel_ids_2
getting a sparse tensor r_adj...
entity:adding the primal init layer
30000 rows, 300 columns.
entity:adding the primal init layer
30000 rows, 300 columns.
relation:adding the primal init layer
342 rows, 300 columns.
relation:adding the primal init layer
342 rows, 300 columns.
value:adding the primal init layer
attribute:adding the primal init layer
INFO:root:Total number of parameters: {tot_params}
Euclidean
INFO:root:BaseModel(
  (ins_embeddings_a): Embedding(30000, 300, max_norm=1)
  (rel_embeddings_a): Embedding(685, 300, max_norm=1)
  (ins_embeddings_n): Embedding(30000, 300, max_norm=1)
  (rel_embeddings_n): Embedding(685, 300, max_norm=1)
  (encoder): RREA_adapt(
    (rrgat0): RelationalReflectionGraphAttentionLayer(
      (attention_0): SpRelationalReflectionGraphAttentionLayer (600 -> 600)
    )
    (hact0): HypAct(
      c_in=Parameter containing:
      tensor([1.], requires_grad=True), c_out=Parameter containing:
      tensor([1.], requires_grad=True)
    )
    (rrgat1): RelationalReflectionGraphAttentionLayer(
      (attention_0): SpRelationalReflectionGraphAttentionLayer (600 -> 600)
    )
    (hact1): HypAct(
      c_in=Parameter containing:
      tensor([1.], requires_grad=True), c_out=Parameter containing:
      tensor([1.], requires_grad=True)
    )
  )
  (decoder): RREA_adapt()
)
ins_embeddings_a.weight
rel_embeddings_a.weight
ins_embeddings_n.weight
rel_embeddings_n.weight
encoder.rrgat0.curvature
encoder.rrgat0.attention_0.a
encoder.hact0.c_out
encoder.rrgat1.attention_0.a
encoder.hact1.c_out
Train Entity Alignment:Hits@1: 99.97%Hits@10: 100.00%Hits@50: 100.00%MRR: 0.9998
Valid Entity Alignment:Hits@1: 99.00%Hits@10: 99.67%Hits@50: 99.80%MRR: 0.9922
Test Entity Alignment:Hits@1: 96.86%Hits@10: 98.95%Hits@50: 99.46%MRR: 0.9770
start training...
######################## epoch:  0  ###########################
Valid Entity Alignment:Hits@1: 99.07%MRR: 0.9928
Test Entity Alignment:Hits@1: 96.95%Hits@10: 98.99%Hits@50: 99.48%MRR: 0.9778
Test Entity Alignment:Hits@1: 96.95%Hits@10: 98.99%Hits@50: 99.48%MRR: 0.9778
######################## epoch:  1  ###########################
Valid Entity Alignment:Hits@1: 99.07%MRR: 0.9928
Test Entity Alignment:Hits@1: 97.09%Hits@10: 99.01%Hits@50: 99.50%MRR: 0.9788
Test Entity Alignment:Hits@1: 97.09%Hits@10: 99.01%Hits@50: 99.50%MRR: 0.9788
######################## epoch:  2  ###########################
Valid Entity Alignment:Hits@1: 99.13%MRR: 0.9933
Test Entity Alignment:Hits@1: 97.16%Hits@10: 99.06%Hits@50: 99.50%MRR: 0.9794
Test Entity Alignment:Hits@1: 97.16%Hits@10: 99.06%Hits@50: 99.50%MRR: 0.9794
######################## epoch:  3  ###########################
Valid Entity Alignment:Hits@1: 99.13%MRR: 0.9936
Test Entity Alignment:Hits@1: 97.23%Hits@10: 99.10%Hits@50: 99.52%MRR: 0.9798
Test Entity Alignment:Hits@1: 97.23%Hits@10: 99.10%Hits@50: 99.52%MRR: 0.9798
######################## epoch:  4  ###########################
Valid Entity Alignment:Hits@1: 99.27%MRR: 0.9946
Test Entity Alignment:Hits@1: 97.28%Hits@10: 99.14%Hits@50: 99.55%MRR: 0.9802
Test Entity Alignment:Hits@1: 97.28%Hits@10: 99.14%Hits@50: 99.55%MRR: 0.9802
######################## epoch:  5  ###########################
Valid Entity Alignment:Hits@1: 99.27%MRR: 0.9946
Test Entity Alignment:Hits@1: 97.32%Hits@10: 99.16%Hits@50: 99.55%MRR: 0.9806
Test Entity Alignment:Hits@1: 97.32%Hits@10: 99.16%Hits@50: 99.55%MRR: 0.9806
######################## epoch:  6  ###########################
Valid Entity Alignment:Hits@1: 99.27%MRR: 0.9946
Test Entity Alignment:Hits@1: 97.36%Hits@10: 99.18%Hits@50: 99.54%MRR: 0.9808
Test Entity Alignment:Hits@1: 97.36%Hits@10: 99.18%Hits@50: 99.54%MRR: 0.9808
######################## epoch:  7  ###########################
Valid Entity Alignment:Hits@1: 99.33%MRR: 0.9949
Test Entity Alignment:Hits@1: 97.40%Hits@10: 99.21%Hits@50: 99.56%MRR: 0.9811
Test Entity Alignment:Hits@1: 97.40%Hits@10: 99.21%Hits@50: 99.56%MRR: 0.9811
######################## epoch:  8  ###########################
Valid Entity Alignment:Hits@1: 99.40%MRR: 0.9953
Test Entity Alignment:Hits@1: 97.43%Hits@10: 99.25%Hits@50: 99.58%MRR: 0.9813
Test Entity Alignment:Hits@1: 97.43%Hits@10: 99.25%Hits@50: 99.58%MRR: 0.9813
######################## epoch:  9  ###########################
Valid Entity Alignment:Hits@1: 99.40%MRR: 0.9953
Test Entity Alignment:Hits@1: 97.45%Hits@10: 99.25%Hits@50: 99.61%MRR: 0.9815
######################## epoch:  10  ###########################
Valid Entity Alignment:Hits@1: 99.40%MRR: 0.9953
Test Entity Alignment:Hits@1: 97.43%Hits@10: 99.22%Hits@50: 99.60%MRR: 0.9815
######################## epoch:  11  ###########################
Valid Entity Alignment:Hits@1: 99.40%MRR: 0.9953
Test Entity Alignment:Hits@1: 97.44%Hits@10: 99.24%Hits@50: 99.60%MRR: 0.9817
######################## epoch:  12  ###########################
Valid Entity Alignment:Hits@1: 99.33%MRR: 0.9949
Test Entity Alignment:Hits@1: 97.46%Hits@10: 99.26%Hits@50: 99.61%MRR: 0.9819
######################## epoch:  13  ###########################
Valid Entity Alignment:Hits@1: 99.33%MRR: 0.9949
Test Entity Alignment:Hits@1: 97.47%Hits@10: 99.26%Hits@50: 99.61%MRR: 0.9819
######################## epoch:  14  ###########################
Valid Entity Alignment:Hits@1: 99.33%MRR: 0.9949
Test Entity Alignment:Hits@1: 97.48%Hits@10: 99.26%Hits@50: 99.60%MRR: 0.9820
######################## epoch:  15  ###########################
Valid Entity Alignment:Hits@1: 99.33%MRR: 0.9949
Test Entity Alignment:Hits@1: 97.50%Hits@10: 99.27%Hits@50: 99.61%MRR: 0.9821
######################## epoch:  16  ###########################
Valid Entity Alignment:Hits@1: 99.33%MRR: 0.9949
Test Entity Alignment:Hits@1: 97.48%Hits@10: 99.28%Hits@50: 99.60%MRR: 0.9821
######################## epoch:  17  ###########################
Valid Entity Alignment:Hits@1: 99.20%MRR: 0.9942
Test Entity Alignment:Hits@1: 97.49%Hits@10: 99.29%Hits@50: 99.60%MRR: 0.9821
######################## epoch:  18  ###########################
Valid Entity Alignment:Hits@1: 99.20%MRR: 0.9943
Test Entity Alignment:Hits@1: 97.50%Hits@10: 99.29%Hits@50: 99.62%MRR: 0.9822
######################## epoch:  19  ###########################
Valid Entity Alignment:Hits@1: 99.20%MRR: 0.9943
Test Entity Alignment:Hits@1: 97.51%Hits@10: 99.29%Hits@50: 99.64%MRR: 0.9823
######################## epoch:  20  ###########################
Valid Entity Alignment:Hits@1: 99.20%MRR: 0.9943
Test Entity Alignment:Hits@1: 97.51%Hits@10: 99.30%Hits@50: 99.64%MRR: 0.9823
######################## epoch:  21  ###########################
Valid Entity Alignment:Hits@1: 99.20%MRR: 0.9943
Test Entity Alignment:Hits@1: 97.52%Hits@10: 99.30%Hits@50: 99.64%MRR: 0.9824
######################## epoch:  22  ###########################
Valid Entity Alignment:Hits@1: 99.20%MRR: 0.9943
Test Entity Alignment:Hits@1: 97.52%Hits@10: 99.30%Hits@50: 99.64%MRR: 0.9824
######################## epoch:  23  ###########################
Valid Entity Alignment:Hits@1: 99.27%MRR: 0.9945
Test Entity Alignment:Hits@1: 97.54%Hits@10: 99.30%Hits@50: 99.65%MRR: 0.9825
######################## epoch:  24  ###########################
Valid Entity Alignment:Hits@1: 99.27%MRR: 0.9945
Test Entity Alignment:Hits@1: 97.56%Hits@10: 99.30%Hits@50: 99.65%MRR: 0.9826
######################## epoch:  25  ###########################
Valid Entity Alignment:Hits@1: 99.27%MRR: 0.9946
Test Entity Alignment:Hits@1: 97.55%Hits@10: 99.32%Hits@50: 99.65%MRR: 0.9825
######################## epoch:  26  ###########################
Valid Entity Alignment:Hits@1: 99.27%MRR: 0.9946
Test Entity Alignment:Hits@1: 97.56%Hits@10: 99.32%Hits@50: 99.64%MRR: 0.9826
######################## epoch:  27  ###########################
Valid Entity Alignment:Hits@1: 99.27%MRR: 0.9946
Test Entity Alignment:Hits@1: 97.57%Hits@10: 99.32%Hits@50: 99.64%MRR: 0.9826
######################## epoch:  28  ###########################
Valid Entity Alignment:Hits@1: 99.20%MRR: 0.9942
Test Entity Alignment:Hits@1: 97.56%Hits@10: 99.33%Hits@50: 99.64%MRR: 0.9826
######################## epoch:  29  ###########################
Valid Entity Alignment:Hits@1: 99.20%MRR: 0.9942
Test Entity Alignment:Hits@1: 97.56%Hits@10: 99.33%Hits@50: 99.63%MRR: 0.9826
Train Entity Alignment:Hits@1: 100.00%Hits@10: 100.00%Hits@50: 100.00%MRR: 1.0000
Valid Entity Alignment:Hits@1: 99.40%Hits@10: 99.73%Hits@50: 99.87%MRR: 0.9953
Test Entity Alignment:Hits@1: 97.43%Hits@10: 99.25%Hits@50: 99.58%MRR: 0.9813
entity_pair (e1,e2) num is: 750000
Traceback (most recent call last):
  File "main.py", line 249, in <module>
    train(args)
  File "main.py", line 163, in train
    '../../' + args.save_path + '/' + args.dataset + '/' + args.lang +'/'+args.entity_pairs_path, "wb"))
OSError: [Errno 28] No space left on device
nohup: ignoring input
Euclidean
INFO:root:Using:{args.device}
INFO:root:Using seed 1234.
loading a file...../../data/Openea/D_W_15K_V1/ent_links_id
loading a file...../../data/Openea/D_W_15K_V1/test_links
loading a file...../../data/Openea/D_W_15K_V1/train_links
loading a file...../../data/Openea/D_W_15K_V1/valid_links
train ILL num: 3000,valid ILL num: 1500, test ILL num: 10500
train ILL | valid ILL |test ILL num: 15000
train ILL & valid ILL &test ILL num: 0
loading a file...../../data/Openea/D_W_15K_V1/triples_1
loading a file...../../data/Openea/D_W_15K_V1/triples_2
loading a (id2object)file...  ../../data/Openea/D_W_15K_V1/ent_ids_1
loading a (id2object)file...  ../../data/Openea/D_W_15K_V1/ent_ids_2
loading a (id2object)file...  ../../data/Openea/D_W_15K_V1/rel_ids_1
loading a (id2object)file...  ../../data/Openea/D_W_15K_V1/rel_ids_2
getting a sparse tensor r_adj...
/home/huangpeng/syn-master/src/Attribute/load_data.py:13: RuntimeWarning: divide by zero encountered in power
  r_inv_sqrt = np.power(rowsum, -0.5).flatten()
/home/huangpeng/syn-master/src/Attribute/load_data.py:26: RuntimeWarning: divide by zero encountered in power
  r_inv_sqrt = np.power(rowsum, -1).flatten()
entity:adding the primal init layer
30000 rows, 300 columns.
entity:adding the primal init layer
30000 rows, 300 columns.
relation:adding the primal init layer
417 rows, 300 columns.
relation:adding the primal init layer
417 rows, 300 columns.
value:adding the primal init layer
attribute:adding the primal init layer
INFO:root:Total number of parameters: {tot_params}
Euclidean
INFO:root:BaseModel(
  (ins_embeddings_a): Embedding(30000, 300, max_norm=1)
  (rel_embeddings_a): Embedding(835, 300, max_norm=1)
  (ins_embeddings_n): Embedding(30000, 300, max_norm=1)
  (rel_embeddings_n): Embedding(835, 300, max_norm=1)
  (encoder): RREA_adapt(
    (rrgat0): RelationalReflectionGraphAttentionLayer(
      (attention_0): SpRelationalReflectionGraphAttentionLayer (600 -> 600)
    )
    (hact0): HypAct(
      c_in=Parameter containing:
      tensor([1.], requires_grad=True), c_out=Parameter containing:
      tensor([1.], requires_grad=True)
    )
    (rrgat1): RelationalReflectionGraphAttentionLayer(
      (attention_0): SpRelationalReflectionGraphAttentionLayer (600 -> 600)
    )
    (hact1): HypAct(
      c_in=Parameter containing:
      tensor([1.], requires_grad=True), c_out=Parameter containing:
      tensor([1.], requires_grad=True)
    )
  )
  (decoder): RREA_adapt()
)
ins_embeddings_a.weight
rel_embeddings_a.weight
ins_embeddings_n.weight
rel_embeddings_n.weight
encoder.rrgat0.curvature
encoder.rrgat0.attention_0.a
encoder.hact0.c_out
encoder.rrgat1.attention_0.a
encoder.hact1.c_out
Train Entity Alignment:Hits@1: 46.73%Hits@10: 63.10%Hits@50: 72.27%MRR: 0.5256
Valid Entity Alignment:Hits@1: 44.47%Hits@10: 58.00%Hits@50: 66.27%MRR: 0.4937
Test Entity Alignment:Hits@1: 32.18%Hits@10: 45.00%Hits@50: 54.39%MRR: 0.3666
start training...
######################## epoch:  0  ###########################
Valid Entity Alignment:Hits@1: 46.40%MRR: 0.5093
Test Entity Alignment:Hits@1: 33.41%Hits@10: 46.51%Hits@50: 55.70%MRR: 0.3796
Test Entity Alignment:Hits@1: 33.41%Hits@10: 46.51%Hits@50: 55.70%MRR: 0.3796
######################## epoch:  1  ###########################
Valid Entity Alignment:Hits@1: 47.53%MRR: 0.5209
Test Entity Alignment:Hits@1: 34.73%Hits@10: 48.08%Hits@50: 56.98%MRR: 0.3936
Test Entity Alignment:Hits@1: 34.73%Hits@10: 48.08%Hits@50: 56.98%MRR: 0.3936
######################## epoch:  2  ###########################
Valid Entity Alignment:Hits@1: 48.73%MRR: 0.5328
Test Entity Alignment:Hits@1: 35.94%Hits@10: 49.50%Hits@50: 58.26%MRR: 0.4063
Test Entity Alignment:Hits@1: 35.94%Hits@10: 49.50%Hits@50: 58.26%MRR: 0.4063
######################## epoch:  3  ###########################
Valid Entity Alignment:Hits@1: 49.93%MRR: 0.5442
Test Entity Alignment:Hits@1: 37.19%Hits@10: 50.98%Hits@50: 59.54%MRR: 0.4195
Test Entity Alignment:Hits@1: 37.19%Hits@10: 50.98%Hits@50: 59.54%MRR: 0.4195
######################## epoch:  4  ###########################
Valid Entity Alignment:Hits@1: 51.07%MRR: 0.5557
Test Entity Alignment:Hits@1: 38.45%Hits@10: 52.27%Hits@50: 60.71%MRR: 0.4323
Test Entity Alignment:Hits@1: 38.45%Hits@10: 52.27%Hits@50: 60.71%MRR: 0.4323
######################## epoch:  5  ###########################
Valid Entity Alignment:Hits@1: 52.13%MRR: 0.5661
Test Entity Alignment:Hits@1: 39.51%Hits@10: 53.45%Hits@50: 62.05%MRR: 0.4444
Test Entity Alignment:Hits@1: 39.51%Hits@10: 53.45%Hits@50: 62.05%MRR: 0.4444
######################## epoch:  6  ###########################
Valid Entity Alignment:Hits@1: 53.07%MRR: 0.5752
nohup: ignoring input
Euclidean
INFO:root:Using:{args.device}
INFO:root:Using seed 1234.
loading a file...../../data/Openea/D_W_15K_V1/ent_links_id
loading a file...../../data/Openea/D_W_15K_V1/test_links
loading a file...../../data/Openea/D_W_15K_V1/train_links
loading a file...../../data/Openea/D_W_15K_V1/valid_links
train ILL num: 3000,valid ILL num: 1500, test ILL num: 10500
train ILL | valid ILL |test ILL num: 15000
train ILL & valid ILL &test ILL num: 0
loading a file...../../data/Openea/D_W_15K_V1/triples_1
loading a file...../../data/Openea/D_W_15K_V1/triples_2
loading a (id2object)file...  ../../data/Openea/D_W_15K_V1/ent_ids_1
loading a (id2object)file...  ../../data/Openea/D_W_15K_V1/ent_ids_2
loading a (id2object)file...  ../../data/Openea/D_W_15K_V1/rel_ids_1
loading a (id2object)file...  ../../data/Openea/D_W_15K_V1/rel_ids_2
getting a sparse tensor r_adj...
/home/huangpeng/syn-master/src/Attribute/load_data.py:13: RuntimeWarning: divide by zero encountered in power
  r_inv_sqrt = np.power(rowsum, -0.5).flatten()
/home/huangpeng/syn-master/src/Attribute/load_data.py:26: RuntimeWarning: divide by zero encountered in power
  r_inv_sqrt = np.power(rowsum, -1).flatten()
entity:adding the primal init layer
30000 rows, 300 columns.
entity:adding the primal init layer
30000 rows, 300 columns.
relation:adding the primal init layer
417 rows, 300 columns.
relation:adding the primal init layer
417 rows, 300 columns.
value:adding the primal init layer
attribute:adding the primal init layer
INFO:root:Total number of parameters: {tot_params}
Euclidean
INFO:root:BaseModel(
  (ins_embeddings_a): Embedding(30000, 300, max_norm=1)
  (rel_embeddings_a): Embedding(835, 300, max_norm=1)
  (encoder): RREA_adapt(
    (rrgat0): RelationalReflectionGraphAttentionLayer(
      (attention_0): SpRelationalReflectionGraphAttentionLayer (300 -> 300)
    )
    (hact0): HypAct(
      c_in=Parameter containing:
      tensor([1.], requires_grad=True), c_out=Parameter containing:
      tensor([1.], requires_grad=True)
    )
    (rrgat1): RelationalReflectionGraphAttentionLayer(
      (attention_0): SpRelationalReflectionGraphAttentionLayer (300 -> 300)
    )
    (hact1): HypAct(
      c_in=Parameter containing:
      tensor([1.], requires_grad=True), c_out=Parameter containing:
      tensor([1.], requires_grad=True)
    )
  )
  (decoder): RREA_adapt()
)
ins_embeddings_a.weight
rel_embeddings_a.weight
encoder.rrgat0.curvature
encoder.rrgat0.attention_0.a
encoder.hact0.c_out
encoder.rrgat1.attention_0.a
encoder.hact1.c_out
Train Entity Alignment:Hits@1: 81.77%Hits@10: 88.10%Hits@50: 91.60%MRR: 0.8412
Valid Entity Alignment:Hits@1: 72.20%Hits@10: 80.40%Hits@50: 85.60%MRR: 0.7509
Test Entity Alignment:Hits@1: 65.93%Hits@10: 74.50%Hits@50: 78.87%MRR: 0.6902
start training...
######################## epoch:  0  ###########################
Valid Entity Alignment:Hits@1: 72.87%MRR: 0.7569
Test Entity Alignment:Hits@1: 66.35%Hits@10: 75.09%Hits@50: 79.48%MRR: 0.6947
Test Entity Alignment:Hits@1: 66.35%Hits@10: 75.09%Hits@50: 79.48%MRR: 0.6947
######################## epoch:  1  ###########################
Valid Entity Alignment:Hits@1: 73.13%MRR: 0.7596
Test Entity Alignment:Hits@1: 66.80%Hits@10: 75.60%Hits@50: 80.05%MRR: 0.6996
Test Entity Alignment:Hits@1: 66.80%Hits@10: 75.60%Hits@50: 80.05%MRR: 0.6996
######################## epoch:  2  ###########################
Valid Entity Alignment:Hits@1: 73.67%MRR: 0.7643
Test Entity Alignment:Hits@1: 67.22%Hits@10: 76.02%Hits@50: 80.54%MRR: 0.7042
Test Entity Alignment:Hits@1: 67.22%Hits@10: 76.02%Hits@50: 80.54%MRR: 0.7042
######################## epoch:  3  ###########################
Valid Entity Alignment:Hits@1: 74.07%MRR: 0.7683
Test Entity Alignment:Hits@1: 67.55%Hits@10: 76.52%Hits@50: 80.96%MRR: 0.7080
Test Entity Alignment:Hits@1: 67.55%Hits@10: 76.52%Hits@50: 80.96%MRR: 0.7080
######################## epoch:  4  ###########################
Valid Entity Alignment:Hits@1: 74.60%MRR: 0.7734
Test Entity Alignment:Hits@1: 67.96%Hits@10: 76.94%Hits@50: 81.44%MRR: 0.7120
Test Entity Alignment:Hits@1: 67.96%Hits@10: 76.94%Hits@50: 81.44%MRR: 0.7120
######################## epoch:  5  ###########################
Valid Entity Alignment:Hits@1: 75.07%MRR: 0.7776
Test Entity Alignment:Hits@1: 68.40%Hits@10: 77.44%Hits@50: 81.96%MRR: 0.7163
Test Entity Alignment:Hits@1: 68.40%Hits@10: 77.44%Hits@50: 81.96%MRR: 0.7163
######################## epoch:  6  ###########################
Valid Entity Alignment:Hits@1: 75.60%MRR: 0.7823
Test Entity Alignment:Hits@1: 68.86%Hits@10: 77.90%Hits@50: 82.57%MRR: 0.7206
Test Entity Alignment:Hits@1: 68.86%Hits@10: 77.90%Hits@50: 82.57%MRR: 0.7206
######################## epoch:  7  ###########################
Valid Entity Alignment:Hits@1: 76.00%MRR: 0.7865
Test Entity Alignment:Hits@1: 69.17%Hits@10: 78.30%Hits@50: 82.98%MRR: 0.7239
Test Entity Alignment:Hits@1: 69.17%Hits@10: 78.30%Hits@50: 82.98%MRR: 0.7239
######################## epoch:  8  ###########################
Valid Entity Alignment:Hits@1: 76.33%MRR: 0.7905
Test Entity Alignment:Hits@1: 69.39%Hits@10: 78.79%Hits@50: 83.40%MRR: 0.7271
Test Entity Alignment:Hits@1: 69.39%Hits@10: 78.79%Hits@50: 83.40%MRR: 0.7271
######################## epoch:  9  ###########################
Valid Entity Alignment:Hits@1: 76.47%MRR: 0.7929
Test Entity Alignment:Hits@1: 69.58%Hits@10: 79.30%Hits@50: 83.89%MRR: 0.7300
Test Entity Alignment:Hits@1: 69.58%Hits@10: 79.30%Hits@50: 83.89%MRR: 0.7300
######################## epoch:  10  ###########################
Valid Entity Alignment:Hits@1: 77.13%MRR: 0.7980
Test Entity Alignment:Hits@1: 69.92%Hits@10: 79.66%Hits@50: 84.33%MRR: 0.7338
Test Entity Alignment:Hits@1: 69.92%Hits@10: 79.66%Hits@50: 84.33%MRR: 0.7338
######################## epoch:  11  ###########################
Valid Entity Alignment:Hits@1: 77.53%MRR: 0.8017
Test Entity Alignment:Hits@1: 70.14%Hits@10: 80.09%Hits@50: 84.61%MRR: 0.7367
Test Entity Alignment:Hits@1: 70.14%Hits@10: 80.09%Hits@50: 84.61%MRR: 0.7367
######################## epoch:  12  ###########################
Valid Entity Alignment:Hits@1: 77.73%MRR: 0.8037
Test Entity Alignment:Hits@1: 70.49%Hits@10: 80.46%Hits@50: 85.04%MRR: 0.7401
Test Entity Alignment:Hits@1: 70.49%Hits@10: 80.46%Hits@50: 85.04%MRR: 0.7401
######################## epoch:  13  ###########################
Valid Entity Alignment:Hits@1: 78.00%MRR: 0.8068
Test Entity Alignment:Hits@1: 70.88%Hits@10: 80.76%Hits@50: 85.33%MRR: 0.7438
Test Entity Alignment:Hits@1: 70.88%Hits@10: 80.76%Hits@50: 85.33%MRR: 0.7438
######################## epoch:  14  ###########################
Valid Entity Alignment:Hits@1: 78.27%MRR: 0.8098
Test Entity Alignment:Hits@1: 71.05%Hits@10: 80.97%Hits@50: 85.70%MRR: 0.7460
Test Entity Alignment:Hits@1: 71.05%Hits@10: 80.97%Hits@50: 85.70%MRR: 0.7460
######################## epoch:  15  ###########################
Valid Entity Alignment:Hits@1: 78.53%MRR: 0.8131
Test Entity Alignment:Hits@1: 71.25%Hits@10: 81.18%Hits@50: 86.01%MRR: 0.7484
Test Entity Alignment:Hits@1: 71.25%Hits@10: 81.18%Hits@50: 86.01%MRR: 0.7484
######################## epoch:  16  ###########################
Valid Entity Alignment:Hits@1: 78.80%MRR: 0.8156
Test Entity Alignment:Hits@1: 71.59%Hits@10: 81.45%Hits@50: 86.34%MRR: 0.7512
Test Entity Alignment:Hits@1: 71.59%Hits@10: 81.45%Hits@50: 86.34%MRR: 0.7512
######################## epoch:  17  ###########################
Valid Entity Alignment:Hits@1: 78.87%MRR: 0.8168
Test Entity Alignment:Hits@1: 71.82%Hits@10: 81.74%Hits@50: 86.66%MRR: 0.7535
Test Entity Alignment:Hits@1: 71.82%Hits@10: 81.74%Hits@50: 86.66%MRR: 0.7535
######################## epoch:  18  ###########################
Valid Entity Alignment:Hits@1: 79.07%MRR: 0.8194
Test Entity Alignment:Hits@1: 72.05%Hits@10: 82.12%Hits@50: 86.87%MRR: 0.7560
Test Entity Alignment:Hits@1: 72.05%Hits@10: 82.12%Hits@50: 86.87%MRR: 0.7560
######################## epoch:  19  ###########################
Valid Entity Alignment:Hits@1: 79.27%MRR: 0.8220
Test Entity Alignment:Hits@1: 72.20%Hits@10: 82.26%Hits@50: 87.15%MRR: 0.7579
Test Entity Alignment:Hits@1: 72.20%Hits@10: 82.26%Hits@50: 87.15%MRR: 0.7579
######################## epoch:  20  ###########################
Valid Entity Alignment:Hits@1: 79.60%MRR: 0.8251
Test Entity Alignment:Hits@1: 72.40%Hits@10: 82.50%Hits@50: 87.50%MRR: 0.7600
Test Entity Alignment:Hits@1: 72.40%Hits@10: 82.50%Hits@50: 87.50%MRR: 0.7600
######################## epoch:  21  ###########################
Valid Entity Alignment:Hits@1: 79.67%MRR: 0.8264
Test Entity Alignment:Hits@1: 72.48%Hits@10: 82.83%Hits@50: 87.69%MRR: 0.7615
Test Entity Alignment:Hits@1: 72.48%Hits@10: 82.83%Hits@50: 87.69%MRR: 0.7615
######################## epoch:  22  ###########################
Valid Entity Alignment:Hits@1: 80.07%MRR: 0.8294
Test Entity Alignment:Hits@1: 72.63%Hits@10: 83.05%Hits@50: 87.85%MRR: 0.7633
Test Entity Alignment:Hits@1: 72.63%Hits@10: 83.05%Hits@50: 87.85%MRR: 0.7633
######################## epoch:  23  ###########################
Valid Entity Alignment:Hits@1: 80.47%MRR: 0.8323
Test Entity Alignment:Hits@1: 72.78%Hits@10: 83.25%Hits@50: 88.06%MRR: 0.7651
Test Entity Alignment:Hits@1: 72.78%Hits@10: 83.25%Hits@50: 88.06%MRR: 0.7651
######################## epoch:  24  ###########################
Valid Entity Alignment:Hits@1: 80.67%MRR: 0.8345
Test Entity Alignment:Hits@1: 72.90%Hits@10: 83.47%Hits@50: 88.23%MRR: 0.7665
Test Entity Alignment:Hits@1: 72.90%Hits@10: 83.47%Hits@50: 88.23%MRR: 0.7665
######################## epoch:  25  ###########################
Valid Entity Alignment:Hits@1: 80.87%MRR: 0.8369
Test Entity Alignment:Hits@1: 72.99%Hits@10: 83.68%Hits@50: 88.39%MRR: 0.7678
Test Entity Alignment:Hits@1: 72.99%Hits@10: 83.68%Hits@50: 88.39%MRR: 0.7678
######################## epoch:  26  ###########################
Valid Entity Alignment:Hits@1: 80.93%MRR: 0.8379
Test Entity Alignment:Hits@1: 73.18%Hits@10: 83.85%Hits@50: 88.54%MRR: 0.7696
Test Entity Alignment:Hits@1: 73.18%Hits@10: 83.85%Hits@50: 88.54%MRR: 0.7696
######################## epoch:  27  ###########################
Valid Entity Alignment:Hits@1: 81.07%MRR: 0.8392
Test Entity Alignment:Hits@1: 73.27%Hits@10: 84.07%Hits@50: 88.69%MRR: 0.7707
Test Entity Alignment:Hits@1: 73.27%Hits@10: 84.07%Hits@50: 88.69%MRR: 0.7707
######################## epoch:  28  ###########################
Valid Entity Alignment:Hits@1: 81.07%MRR: 0.8400
Test Entity Alignment:Hits@1: 73.44%Hits@10: 84.28%Hits@50: 88.72%MRR: 0.7722
Test Entity Alignment:Hits@1: 73.44%Hits@10: 84.28%Hits@50: 88.72%MRR: 0.7722
######################## epoch:  29  ###########################
Valid Entity Alignment:Hits@1: 81.13%MRR: 0.8406
Test Entity Alignment:Hits@1: 73.59%Hits@10: 84.37%Hits@50: 88.85%MRR: 0.7737
Test Entity Alignment:Hits@1: 73.59%Hits@10: 84.37%Hits@50: 88.85%MRR: 0.7737
######################## epoch:  30  ###########################
Valid Entity Alignment:Hits@1: 81.07%MRR: 0.8410
Test Entity Alignment:Hits@1: 73.67%Hits@10: 84.49%Hits@50: 88.92%MRR: 0.7745
Test Entity Alignment:Hits@1: 73.67%Hits@10: 84.49%Hits@50: 88.92%MRR: 0.7745
######################## epoch:  31  ###########################
Valid Entity Alignment:Hits@1: 81.07%MRR: 0.8415
Test Entity Alignment:Hits@1: 73.70%Hits@10: 84.63%Hits@50: 89.02%MRR: 0.7752
Test Entity Alignment:Hits@1: 73.70%Hits@10: 84.63%Hits@50: 89.02%MRR: 0.7752
######################## epoch:  32  ###########################
Valid Entity Alignment:Hits@1: 81.07%MRR: 0.8421
Test Entity Alignment:Hits@1: 73.78%Hits@10: 84.76%Hits@50: 89.15%MRR: 0.7759
Test Entity Alignment:Hits@1: 73.78%Hits@10: 84.76%Hits@50: 89.15%MRR: 0.7759
######################## epoch:  33  ###########################
Valid Entity Alignment:Hits@1: 81.07%MRR: 0.8425
Test Entity Alignment:Hits@1: 73.83%Hits@10: 84.86%Hits@50: 89.20%MRR: 0.7767
Test Entity Alignment:Hits@1: 73.83%Hits@10: 84.86%Hits@50: 89.20%MRR: 0.7767
######################## epoch:  34  ###########################
Valid Entity Alignment:Hits@1: 81.07%MRR: 0.8431
Test Entity Alignment:Hits@1: 73.95%Hits@10: 84.99%Hits@50: 89.35%MRR: 0.7778
Test Entity Alignment:Hits@1: 73.95%Hits@10: 84.99%Hits@50: 89.35%MRR: 0.7778
######################## epoch:  35  ###########################
Valid Entity Alignment:Hits@1: 81.13%MRR: 0.8436
Test Entity Alignment:Hits@1: 74.04%Hits@10: 85.06%Hits@50: 89.45%MRR: 0.7786
Test Entity Alignment:Hits@1: 74.04%Hits@10: 85.06%Hits@50: 89.45%MRR: 0.7786
######################## epoch:  36  ###########################
Valid Entity Alignment:Hits@1: 81.07%MRR: 0.8437
Test Entity Alignment:Hits@1: 74.14%Hits@10: 85.08%Hits@50: 89.50%MRR: 0.7796
Test Entity Alignment:Hits@1: 74.14%Hits@10: 85.08%Hits@50: 89.50%MRR: 0.7796
######################## epoch:  37  ###########################
Valid Entity Alignment:Hits@1: 81.27%MRR: 0.8451
Test Entity Alignment:Hits@1: 74.22%Hits@10: 85.12%Hits@50: 89.56%MRR: 0.7803
Test Entity Alignment:Hits@1: 74.22%Hits@10: 85.12%Hits@50: 89.56%MRR: 0.7803
######################## epoch:  38  ###########################
Valid Entity Alignment:Hits@1: 81.47%MRR: 0.8460
Test Entity Alignment:Hits@1: 74.26%Hits@10: 85.21%Hits@50: 89.57%MRR: 0.7807
Test Entity Alignment:Hits@1: 74.26%Hits@10: 85.21%Hits@50: 89.57%MRR: 0.7807
######################## epoch:  39  ###########################
Valid Entity Alignment:Hits@1: 81.53%MRR: 0.8464
Test Entity Alignment:Hits@1: 74.29%Hits@10: 85.24%Hits@50: 89.64%MRR: 0.7810
Test Entity Alignment:Hits@1: 74.29%Hits@10: 85.24%Hits@50: 89.64%MRR: 0.7810
######################## epoch:  40  ###########################
Valid Entity Alignment:Hits@1: 81.53%MRR: 0.8465
Test Entity Alignment:Hits@1: 74.31%Hits@10: 85.28%Hits@50: 89.69%MRR: 0.7814
Test Entity Alignment:Hits@1: 74.31%Hits@10: 85.28%Hits@50: 89.69%MRR: 0.7814
######################## epoch:  41  ###########################
Valid Entity Alignment:Hits@1: 81.73%MRR: 0.8477
Test Entity Alignment:Hits@1: 74.32%Hits@10: 85.29%Hits@50: 89.69%MRR: 0.7816
Test Entity Alignment:Hits@1: 74.32%Hits@10: 85.29%Hits@50: 89.69%MRR: 0.7816
######################## epoch:  42  ###########################
Valid Entity Alignment:Hits@1: 81.73%MRR: 0.8480
Test Entity Alignment:Hits@1: 74.34%Hits@10: 85.35%Hits@50: 89.67%MRR: 0.7818
Test Entity Alignment:Hits@1: 74.34%Hits@10: 85.35%Hits@50: 89.67%MRR: 0.7818
######################## epoch:  43  ###########################
Valid Entity Alignment:Hits@1: 81.53%MRR: 0.8468
Test Entity Alignment:Hits@1: 74.37%Hits@10: 85.37%Hits@50: 89.66%MRR: 0.7820
######################## epoch:  44  ###########################
Valid Entity Alignment:Hits@1: 81.60%MRR: 0.8468
Test Entity Alignment:Hits@1: 74.35%Hits@10: 85.34%Hits@50: 89.65%MRR: 0.7819
######################## epoch:  45  ###########################
Valid Entity Alignment:Hits@1: 81.40%MRR: 0.8458
Test Entity Alignment:Hits@1: 74.37%Hits@10: 85.32%Hits@50: 89.60%MRR: 0.7820
######################## epoch:  46  ###########################
Valid Entity Alignment:Hits@1: 81.40%MRR: 0.8458
Test Entity Alignment:Hits@1: 74.38%Hits@10: 85.35%Hits@50: 89.57%MRR: 0.7820
Train Entity Alignment:Hits@1: 100.00%Hits@10: 100.00%Hits@50: 100.00%MRR: 1.0000
Valid Entity Alignment:Hits@1: 81.73%Hits@10: 90.47%Hits@50: 94.07%MRR: 0.8480
Test Entity Alignment:Hits@1: 74.34%Hits@10: 85.35%Hits@50: 89.67%MRR: 0.7818
entity_pair (e1,e2) num is: 750000
False False
nohup: ignoring input
Euclidean
INFO:root:Using:{args.device}
INFO:root:Using seed 1234.
loading a file...../../data/Openea/EN_DE_100K_V1/ent_links_id
loading a file...../../data/Openea/EN_DE_100K_V1/test_links
loading a file...../../data/Openea/EN_DE_100K_V1/train_links
loading a file...../../data/Openea/EN_DE_100K_V1/valid_links
train ILL num: 20000,valid ILL num: 10000, test ILL num: 70000
train ILL | valid ILL |test ILL num: 100000
train ILL & valid ILL &test ILL num: 0
loading a file...../../data/Openea/EN_DE_100K_V1/triples_1
loading a file...../../data/Openea/EN_DE_100K_V1/triples_2
loading a (id2object)file...  ../../data/Openea/EN_DE_100K_V1/ent_ids_1
loading a (id2object)file...  ../../data/Openea/EN_DE_100K_V1/ent_ids_2
loading a (id2object)file...  ../../data/Openea/EN_DE_100K_V1/rel_ids_1
loading a (id2object)file...  ../../data/Openea/EN_DE_100K_V1/rel_ids_2
getting a sparse tensor r_adj...
/home/huangpeng/syn-master/src/Attribute/load_data.py:13: RuntimeWarning: divide by zero encountered in power
  r_inv_sqrt = np.power(rowsum, -0.5).flatten()
/home/huangpeng/syn-master/src/Attribute/load_data.py:26: RuntimeWarning: divide by zero encountered in power
  r_inv_sqrt = np.power(rowsum, -1).flatten()
entity:adding the primal init layer
200000 rows, 300 columns.
entity:adding the primal init layer
200000 rows, 300 columns.
relation:adding the primal init layer
410 rows, 300 columns.
relation:adding the primal init layer
410 rows, 300 columns.
value:adding the primal init layer
attribute:adding the primal init layer
INFO:root:Total number of parameters: {tot_params}
Euclidean
INFO:root:BaseModel(
  (ins_embeddings_a): Embedding(200000, 300, max_norm=1)
  (rel_embeddings_a): Embedding(821, 300, max_norm=1)
  (ins_embeddings_n): Embedding(200000, 300, max_norm=1)
  (rel_embeddings_n): Embedding(821, 300, max_norm=1)
  (encoder): RREA_adapt(
    (rrgat0): RelationalReflectionGraphAttentionLayer(
      (attention_0): SpRelationalReflectionGraphAttentionLayer (600 -> 600)
    )
    (hact0): HypAct(
      c_in=Parameter containing:
      tensor([1.], requires_grad=True), c_out=Parameter containing:
      tensor([1.], requires_grad=True)
    )
    (rrgat1): RelationalReflectionGraphAttentionLayer(
      (attention_0): SpRelationalReflectionGraphAttentionLayer (600 -> 600)
    )
    (hact1): HypAct(
      c_in=Parameter containing:
      tensor([1.], requires_grad=True), c_out=Parameter containing:
      tensor([1.], requires_grad=True)
    )
  )
  (decoder): RREA_adapt()
)
ins_embeddings_a.weight
rel_embeddings_a.weight
ins_embeddings_n.weight
rel_embeddings_n.weight
encoder.rrgat0.curvature
encoder.rrgat0.attention_0.a
encoder.hact0.c_out
encoder.rrgat1.attention_0.a
encoder.hact1.c_out
Train Entity Alignment:Valid Entity Alignment:Test Entity Alignment:start training...
######################## epoch:  0  ###########################
Valid Entity Alignment:Hits@1: 94.96%MRR: 0.9566
######################## epoch:  1  ###########################
Valid Entity Alignment:Hits@1: 95.06%MRR: 0.9575
######################## epoch:  2  ###########################
Valid Entity Alignment:Hits@1: 95.13%MRR: 0.9581
######################## epoch:  3  ###########################
Valid Entity Alignment:Hits@1: 95.25%MRR: 0.9590
######################## epoch:  4  ###########################
Valid Entity Alignment:Hits@1: 95.31%MRR: 0.9596
######################## epoch:  5  ###########################
Valid Entity Alignment:Hits@1: 95.34%MRR: 0.9600
######################## epoch:  6  ###########################
Valid Entity Alignment:Hits@1: 95.34%MRR: 0.9602
######################## epoch:  7  ###########################
Valid Entity Alignment:Hits@1: 95.38%MRR: 0.9607
######################## epoch:  8  ###########################
Valid Entity Alignment:Hits@1: 95.42%MRR: 0.9611
######################## epoch:  9  ###########################
Valid Entity Alignment:Hits@1: 95.47%MRR: 0.9617
######################## epoch:  10  ###########################
Valid Entity Alignment:Hits@1: 95.50%MRR: 0.9621
######################## epoch:  11  ###########################
Valid Entity Alignment:Hits@1: 95.57%MRR: 0.9627
######################## epoch:  12  ###########################
Valid Entity Alignment:Hits@1: 95.59%MRR: 0.9629
######################## epoch:  13  ###########################
Valid Entity Alignment:Hits@1: 95.60%MRR: 0.9631
######################## epoch:  14  ###########################
Valid Entity Alignment:Hits@1: 95.64%MRR: 0.9634
######################## epoch:  15  ###########################
Valid Entity Alignment:Hits@1: 95.70%MRR: 0.9639
######################## epoch:  16  ###########################
Valid Entity Alignment:Hits@1: 95.73%MRR: 0.9642
######################## epoch:  17  ###########################
Valid Entity Alignment:Hits@1: 95.74%MRR: 0.9643
######################## epoch:  18  ###########################
Valid Entity Alignment:Hits@1: 95.75%MRR: 0.9645
######################## epoch:  19  ###########################
Valid Entity Alignment:Hits@1: 95.78%MRR: 0.9647
######################## epoch:  20  ###########################
Valid Entity Alignment:Hits@1: 95.79%MRR: 0.9648
######################## epoch:  21  ###########################
Valid Entity Alignment:Hits@1: 95.81%MRR: 0.9649
######################## epoch:  22  ###########################
Valid Entity Alignment:Hits@1: 95.82%MRR: 0.9650
######################## epoch:  23  ###########################
Valid Entity Alignment:Hits@1: 95.84%MRR: 0.9651
######################## epoch:  24  ###########################
Valid Entity Alignment:Hits@1: 95.85%MRR: 0.9652
######################## epoch:  25  ###########################
Valid Entity Alignment:Hits@1: 95.86%MRR: 0.9653
######################## epoch:  26  ###########################
Valid Entity Alignment:Hits@1: 95.85%MRR: 0.9653
######################## epoch:  27  ###########################
Valid Entity Alignment:Hits@1: 95.86%MRR: 0.9653
######################## epoch:  28  ###########################
Valid Entity Alignment:Hits@1: 95.87%MRR: 0.9654
######################## epoch:  29  ###########################
Valid Entity Alignment:Hits@1: 95.86%MRR: 0.9654
######################## epoch:  30  ###########################
Valid Entity Alignment:Hits@1: 95.86%MRR: 0.9654
######################## epoch:  31  ###########################
Valid Entity Alignment:Hits@1: 95.87%MRR: 0.9654
######################## epoch:  32  ###########################
Valid Entity Alignment:Hits@1: 95.87%MRR: 0.9655
######################## epoch:  33  ###########################
Valid Entity Alignment:Hits@1: 95.89%MRR: 0.9656
######################## epoch:  34  ###########################
Valid Entity Alignment:Hits@1: 95.88%MRR: 0.9656
######################## epoch:  35  ###########################
Valid Entity Alignment:Hits@1: 95.88%MRR: 0.9656
######################## epoch:  36  ###########################
Valid Entity Alignment:Hits@1: 95.86%MRR: 0.9655
######################## epoch:  37  ###########################
Valid Entity Alignment:Hits@1: 95.87%MRR: 0.9656
######################## epoch:  38  ###########################
Valid Entity Alignment:Hits@1: 95.87%MRR: 0.9656
######################## epoch:  39  ###########################
Valid Entity Alignment:Hits@1: 95.88%MRR: 0.9657
######################## epoch:  40  ###########################
Valid Entity Alignment:Hits@1: 95.89%MRR: 0.9657
######################## epoch:  41  ###########################
Valid Entity Alignment:Hits@1: 95.91%MRR: 0.9658
######################## epoch:  42  ###########################
Valid Entity Alignment:Hits@1: 95.91%MRR: 0.9658
######################## epoch:  43  ###########################
Valid Entity Alignment:Hits@1: 95.92%MRR: 0.9658
######################## epoch:  44  ###########################
Valid Entity Alignment:Hits@1: 95.92%MRR: 0.9658
######################## epoch:  45  ###########################
Valid Entity Alignment:Hits@1: 95.93%MRR: 0.9659
######################## epoch:  46  ###########################
Valid Entity Alignment:Hits@1: 95.94%MRR: 0.9659
######################## epoch:  47  ###########################
Valid Entity Alignment:Hits@1: 95.94%MRR: 0.9659
######################## epoch:  48  ###########################
Valid Entity Alignment:Hits@1: 95.94%MRR: 0.9659
######################## epoch:  49  ###########################
Valid Entity Alignment:Hits@1: 95.94%MRR: 0.9659
######################## epoch:  50  ###########################
Valid Entity Alignment:Hits@1: 95.94%MRR: 0.9660
######################## epoch:  51  ###########################
Valid Entity Alignment:Hits@1: 95.94%MRR: 0.9660
######################## epoch:  52  ###########################
Valid Entity Alignment:Hits@1: 95.95%MRR: 0.9660
######################## epoch:  53  ###########################
Valid Entity Alignment:Hits@1: 95.95%MRR: 0.9660
######################## epoch:  54  ###########################
Valid Entity Alignment:Hits@1: 95.96%MRR: 0.9661
######################## epoch:  55  ###########################
Valid Entity Alignment:Hits@1: 95.97%MRR: 0.9661
######################## epoch:  56  ###########################
Valid Entity Alignment:Hits@1: 95.96%MRR: 0.9661
######################## epoch:  57  ###########################
Valid Entity Alignment:Hits@1: 95.96%MRR: 0.9661
######################## epoch:  58  ###########################
Valid Entity Alignment:Hits@1: 95.96%MRR: 0.9661
######################## epoch:  59  ###########################
Valid Entity Alignment:Hits@1: 95.96%MRR: 0.9661
Train Entity Alignment:Hits@1: 100.00%Hits@10: 100.00%Hits@50: 100.00%MRR: 1.0000
Valid Entity Alignment:Hits@1: 95.97%Hits@10: 97.84%Hits@50: 98.65%MRR: 0.9661
Test Entity Alignment:Hits@1: 94.67%Hits@10: 96.87%Hits@50: 97.72%MRR: 0.9549
entity_pair (e1,e2) num is: 5000000
False False
INFO:root:Using:{args.device}
INFO:root:Using seed 1234.
loading a file...../../data/Openea/EN_FR_100K_V1/ent_links_id
loading a file...../../data/Openea/EN_FR_100K_V1/test_links
loading a file...../../data/Openea/EN_FR_100K_V1/train_links
loading a file...../../data/Openea/EN_FR_100K_V1/valid_links
train ILL num: 20000,valid ILL num: 10000, test ILL num: 70000
train ILL | valid ILL |test ILL num: 100000
train ILL & valid ILL &test ILL num: 0
loading a file...../../data/Openea/EN_FR_100K_V1/triples_1
loading a file...../../data/Openea/EN_FR_100K_V1/triples_2
loading a (id2object)file...  ../../data/Openea/EN_FR_100K_V1/ent_ids_1
loading a (id2object)file...  ../../data/Openea/EN_FR_100K_V1/ent_ids_2
loading a (id2object)file...  ../../data/Openea/EN_FR_100K_V1/rel_ids_1
loading a (id2object)file...  ../../data/Openea/EN_FR_100K_V1/rel_ids_2
getting a sparse tensor r_adj...
nohup: ignoring input
Euclidean
INFO:root:Using:{args.device}
INFO:root:Using seed 1234.
loading a file...../../data/Openea/EN_DE_100K_V1/ent_links_id
loading a file...../../data/Openea/EN_DE_100K_V1/test_links
loading a file...../../data/Openea/EN_DE_100K_V1/train_links
loading a file...../../data/Openea/EN_DE_100K_V1/valid_links
train ILL num: 20000,valid ILL num: 10000, test ILL num: 70000
train ILL | valid ILL |test ILL num: 100000
train ILL & valid ILL &test ILL num: 0
loading a file...../../data/Openea/EN_DE_100K_V1/triples_1
loading a file...../../data/Openea/EN_DE_100K_V1/triples_2
loading a (id2object)file...  ../../data/Openea/EN_DE_100K_V1/ent_ids_1
loading a (id2object)file...  ../../data/Openea/EN_DE_100K_V1/ent_ids_2
loading a (id2object)file...  ../../data/Openea/EN_DE_100K_V1/rel_ids_1
loading a (id2object)file...  ../../data/Openea/EN_DE_100K_V1/rel_ids_2
getting a sparse tensor r_adj...
/home/huangpeng/syn-master/src/Attribute/load_data.py:13: RuntimeWarning: divide by zero encountered in power
  r_inv_sqrt = np.power(rowsum, -0.5).flatten()
/home/huangpeng/syn-master/src/Attribute/load_data.py:26: RuntimeWarning: divide by zero encountered in power
  r_inv_sqrt = np.power(rowsum, -1).flatten()
entity:adding the primal init layer
200000 rows, 300 columns.
entity:adding the primal init layer
200000 rows, 300 columns.
relation:adding the primal init layer
410 rows, 300 columns.
relation:adding the primal init layer
410 rows, 300 columns.
value:adding the primal init layer
564874 rows, 300 columns.
attribute:adding the primal init layer
699 rows, 300 columns.
INFO:root:Total number of parameters: {tot_params}
Euclidean
Test(get candidate) embedding shape: torch.Size([20000, 300]) torch.Size([20000, 300])
get candidate by cosine similartity.
Test(get candidate) embedding shape: torch.Size([10000, 300]) torch.Size([10000, 300])
get candidate by cosine similartity.
Test(get candidate) embedding shape: torch.Size([70000, 300]) torch.Size([70000, 300])
get candidate by cosine similartity.
/home/huangpeng/anaconda3/envs/py36/lib/python3.6/site-packages/torch/nn/_reduction.py:44: UserWarning: size_average and reduce args will be deprecated, please use reduction='mean' instead.
  warnings.warn(warning.format(ret))
INFO:root:BaseModel(
  (ins_embeddings_a): Embedding(200000, 300, max_norm=1)
  (rel_embeddings_a): Embedding(411, 300, max_norm=1)
  (ins_embeddings_n): Embedding(200000, 300, max_norm=1)
  (rel_embeddings_n): Embedding(411, 300, max_norm=1)
  (val_embeddings): Embedding(564874, 300, max_norm=1)
  (encoder): BERT_INT_A()
  (decoder): BERT_INT_A(
    (mlp): MlP(
      (dense1): Linear(in_features=43, out_features=11, bias=True)
      (dense2): Linear(in_features=11, out_features=1, bias=True)
    )
    (Criterion): MarginRankingLoss()
  )
)
ins_embeddings_a.weight
rel_embeddings_a.weight
ins_embeddings_n.weight
rel_embeddings_n.weight
val_embeddings.weight
decoder.mlp.dense1.weight
decoder.mlp.dense1.bias
decoder.mlp.dense2.weight
decoder.mlp.dense2.bias
start training...
In Train_batch_index_generator, train_ILL num : 20000
In Train_batch_index_generator, Batch size: 128
In Train_batch_index_generator, Negative sampling num: 125
######################## epoch:  0  ###########################
/home/huangpeng/anaconda3/envs/py36/lib/python3.6/site-packages/torch/nn/functional.py:1628: UserWarning: nn.functional.tanh is deprecated. Use torch.tanh instead.
  warnings.warn("nn.functional.tanh is deprecated. Use torch.tanh instead.")
Valid Entity Alignment:all test entity pair num 500000/ max align entity pair num: 9865
Hits@1: 0.96470MRR: 0.9647
Test Entity Alignment:all test entity pair num 3500000/ max align entity pair num: 68403
Hits@1: 0.95304Hits@10: 0.97091Hits@50: 0.97719MRR: 0.9600
######################## epoch:  1  ###########################
nohup: ignoring input
Euclidean
INFO:root:Using:{args.device}
INFO:root:Using seed 1234.
loading a file...../../data/Openea/EN_DE_15K_V1/ent_links_id
loading a file...../../data/Openea/EN_DE_15K_V1/test_links
loading a file...../../data/Openea/EN_DE_15K_V1/train_links
loading a file...../../data/Openea/EN_DE_15K_V1/valid_links
train ILL num: 3000,valid ILL num: 1500, test ILL num: 10500
train ILL | valid ILL |test ILL num: 15000
train ILL & valid ILL &test ILL num: 0
loading a file...../../data/Openea/EN_DE_15K_V1/triples_1
loading a file...../../data/Openea/EN_DE_15K_V1/triples_2
loading a (id2object)file...  ../../data/Openea/EN_DE_15K_V1/ent_ids_1
loading a (id2object)file...  ../../data/Openea/EN_DE_15K_V1/ent_ids_2
loading a (id2object)file...  ../../data/Openea/EN_DE_15K_V1/rel_ids_1
loading a (id2object)file...  ../../data/Openea/EN_DE_15K_V1/rel_ids_2
getting a sparse tensor r_adj...
/home/huangpeng/syn-master/src/Attribute/load_data.py:13: RuntimeWarning: divide by zero encountered in power
  r_inv_sqrt = np.power(rowsum, -0.5).flatten()
/home/huangpeng/syn-master/src/Attribute/load_data.py:26: RuntimeWarning: divide by zero encountered in power
  r_inv_sqrt = np.power(rowsum, -1).flatten()
entity:adding the primal init layer
30000 rows, 300 columns.
entity:adding the primal init layer
30000 rows, 300 columns.
relation:adding the primal init layer
239 rows, 300 columns.
relation:adding the primal init layer
239 rows, 300 columns.
value:adding the primal init layer
96607 rows, 300 columns.
attribute:adding the primal init layer
476 rows, 300 columns.
INFO:root:Total number of parameters: {tot_params}
Euclidean
Test(get candidate) embedding shape: torch.Size([3000, 300]) torch.Size([3000, 300])
get candidate by cosine similartity.
Test(get candidate) embedding shape: torch.Size([1500, 300]) torch.Size([1500, 300])
get candidate by cosine similartity.
Test(get candidate) embedding shape: torch.Size([10500, 300]) torch.Size([10500, 300])
get candidate by cosine similartity.
/home/huangpeng/anaconda3/envs/py36/lib/python3.6/site-packages/torch/nn/_reduction.py:44: UserWarning: size_average and reduce args will be deprecated, please use reduction='mean' instead.
  warnings.warn(warning.format(ret))
INFO:root:BaseModel(
  (ins_embeddings_n): Embedding(30000, 300, max_norm=1)
  (rel_embeddings_n): Embedding(240, 300, max_norm=1)
  (val_embeddings): Embedding(96607, 300, max_norm=1)
  (encoder): BERT_INT_A()
  (decoder): BERT_INT_A(
    (mlp): MlP(
      (dense1): Linear(in_features=43, out_features=11, bias=True)
      (dense2): Linear(in_features=11, out_features=1, bias=True)
    )
    (Criterion): MarginRankingLoss()
  )
)
ins_embeddings_n.weight
rel_embeddings_n.weight
val_embeddings.weight
decoder.mlp.dense1.weight
decoder.mlp.dense1.bias
decoder.mlp.dense2.weight
decoder.mlp.dense2.bias
start training...
In Train_batch_index_generator, train_ILL num : 3000
In Train_batch_index_generator, Batch size: 128
In Train_batch_index_generator, Negative sampling num: 125
######################## epoch:  0  ###########################
/home/huangpeng/anaconda3/envs/py36/lib/python3.6/site-packages/torch/nn/functional.py:1628: UserWarning: nn.functional.tanh is deprecated. Use torch.tanh instead.
  warnings.warn("nn.functional.tanh is deprecated. Use torch.tanh instead.")
Valid Entity Alignment:all test entity pair num 75000/ max align entity pair num: 1498
Hits@1: 0.98933MRR: 0.9893
Test Entity Alignment:all test entity pair num 525000/ max align entity pair num: 10417
Hits@1: 0.97171Hits@10: 0.99076Hits@50: 0.99210MRR: 0.9794
######################## epoch:  1  ###########################
Valid Entity Alignment:all test entity pair num 75000/ max align entity pair num: 1498
Hits@1: 0.98933MRR: 0.9893
Train Entity Alignment:all test entity pair num 150000/ max align entity pair num: 3000
Hits@1: 0.99967Hits@10: 1.00000Hits@50: 1.00000MRR: 0.9998
Valid Entity Alignment:all test entity pair num 75000/ max align entity pair num: 1498
Hits@1: 0.98933Hits@10: 0.99733Hits@50: 0.99867MRR: 0.9923
Test Entity Alignment:all test entity pair num 525000/ max align entity pair num: 10417
Hits@1: 0.97171Hits@10: 0.99076Hits@50: 0.99210MRR: 0.9794
INFO:root:Using:{args.device}
INFO:root:Using seed 1234.
loading a file...../../data/Openea/EN_FR_15K_V1/ent_links_id
loading a file...../../data/Openea/EN_FR_15K_V1/test_links
loading a file...../../data/Openea/EN_FR_15K_V1/train_links
loading a file...../../data/Openea/EN_FR_15K_V1/valid_links
train ILL num: 3000,valid ILL num: 1500, test ILL num: 10500
train ILL | valid ILL |test ILL num: 15000
train ILL & valid ILL &test ILL num: 0
loading a file...../../data/Openea/EN_FR_15K_V1/triples_1
loading a file...../../data/Openea/EN_FR_15K_V1/triples_2
loading a (id2object)file...  ../../data/Openea/EN_FR_15K_V1/ent_ids_1
loading a (id2object)file...  ../../data/Openea/EN_FR_15K_V1/ent_ids_2
loading a (id2object)file...  ../../data/Openea/EN_FR_15K_V1/rel_ids_1
loading a (id2object)file...  ../../data/Openea/EN_FR_15K_V1/rel_ids_2
getting a sparse tensor r_adj...
entity:adding the primal init layer
30000 rows, 300 columns.
entity:adding the primal init layer
30000 rows, 300 columns.
relation:adding the primal init layer
342 rows, 300 columns.
relation:adding the primal init layer
342 rows, 300 columns.
value:adding the primal init layer
79209 rows, 300 columns.
attribute:adding the primal init layer
711 rows, 300 columns.
INFO:root:Total number of parameters: {tot_params}
Euclidean
Test(get candidate) embedding shape: torch.Size([3000, 300]) torch.Size([3000, 300])
get candidate by cosine similartity.
Test(get candidate) embedding shape: torch.Size([1500, 300]) torch.Size([1500, 300])
get candidate by cosine similartity.
Test(get candidate) embedding shape: torch.Size([10500, 300]) torch.Size([10500, 300])
get candidate by cosine similartity.
Traceback (most recent call last):
  File "main.py", line 256, in <module>
    train(args)
  File "main.py", line 49, in train
    model = BaseModel(args, data)
  File "../model/attribute_model.py", line 452, in __init__
    args, data, self.ins_embeddings_n.weight.detach(),self.val_embeddings.weight.detach())
  File "../model/attribute_model.py", line 21, in get_bert_int_data
    '../../' + args.save_path + '/' + args.dataset + '/' + args.lang + '/' + args.entity_pairs_path, "rb"))
EOFError: Ran out of input
